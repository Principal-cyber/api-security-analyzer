package com.security.analyzer.model;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@JsonInclude(JsonInclude.Include.NON_NULL)
public class Vulnerability {
    public enum Severity {
        CRITICAL, HIGH, MEDIUM, LOW, INFO
    }

    @JsonProperty("title")
    private String title;

    @JsonProperty("severity")
    private Severity severity;

    @JsonProperty("description")
    private String description;

    @JsonProperty("endpoint")
    private String endpoint;

    @JsonProperty("method")
    private String method;

    @JsonProperty("payload")
    private String payload;

    @JsonProperty("evidence")
    private String evidence;

    @JsonProperty("recommendation")
    private String recommendation;

    @JsonProperty("cwe")
    private String cwe;

    @JsonProperty("owasp_category")
    private String owaspCategory;

    @JsonProperty("http_status")
    private Integer httpStatus;

    @JsonProperty("response_time")
    private Long responseTime;

    // Конструкторы
    public Vulnerability() {}

    public Vulnerability(String title, Severity severity, String description, 
                       String endpoint, String recommendation) {
        this.title = title;
        this.severity = severity;
        this.description = description;
        this.endpoint = endpoint;
        this.recommendation = recommendation;
    }

    // Геттеры и сеттеры
    public String getTitle() { return title; }
    public void setTitle(String title) { this.title = title; }

    public Severity getSeverity() { return severity; }
    public void setSeverity(Severity severity) { this.severity = severity; }

    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }

    public String getEndpoint() { return endpoint; }
    public void setEndpoint(String endpoint) { this.endpoint = endpoint; }

    public String getMethod() { return method; }
    public void setMethod(String method) { this.method = method; }

    public String getPayload() { return payload; }
    public void setPayload(String payload) { this.payload = payload; }

    public String getEvidence() { return evidence; }
    public void setEvidence(String evidence) { this.evidence = evidence; }

    public String getRecommendation() { return recommendation; }
    public void setRecommendation(String recommendation) { this.recommendation = recommendation; }

    public String getCwe() { return cwe; }
    public void setCwe(String cwe) { this.cwe = cwe; }

    public String getOwaspCategory() { return owaspCategory; }
    public void setOwaspCategory(String owaspCategory) { this.owaspCategory = owaspCategory; }

    public Integer getHttpStatus() { return httpStatus; }
    public void setHttpStatus(Integer httpStatus) { this.httpStatus = httpStatus; }

    public Long getResponseTime() { return responseTime; }
    public void setResponseTime(Long responseTime) { this.responseTime = responseTime; }
}
